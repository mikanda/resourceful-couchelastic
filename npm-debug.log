0 info it worked if it ends with ok
1 verbose cli [ '/Users/richardmarr/Projects/nvm/v0.8.14/bin/node',
1 verbose cli   '/Users/richardmarr/Projects/nvm/v0.8.14/bin/npm',
1 verbose cli   'publish' ]
2 info using npm@1.1.65
3 info using node@v0.8.14
4 verbose publish [ '.' ]
5 verbose read json /Users/richardmarr/Projects/resourceful-couchelastic/package.json
6 verbose cache add [ '.', null ]
7 silly cache add name=undefined spec="." args=[".",null]
8 verbose parsed url { pathname: '.', path: '.', href: '.' }
9 silly lockFile 3a52ce78- .
10 verbose lock . /Users/richardmarr/.npm/3a52ce78-.lock
11 verbose read json package.json
12 verbose tar pack [ '/var/folders/MR/MRIyTJw1E2i1tfsl1DrF0E+++TI/-Tmp-/npm-9855/1369069615926-0.5003365385346115/tmp.tgz',
12 verbose tar pack   '.' ]
13 verbose tarball /var/folders/MR/MRIyTJw1E2i1tfsl1DrF0E+++TI/-Tmp-/npm-9855/1369069615926-0.5003365385346115/tmp.tgz
14 verbose folder .
15 info prepublish resourceful-couchelastic@0.1.3
16 silly lockFile 3d7030a5-15926-0-5003365385346115-tmp-tgz /var/folders/MR/MRIyTJw1E2i1tfsl1DrF0E+++TI/-Tmp-/npm-9855/1369069615926-0.5003365385346115/tmp.tgz
17 verbose lock /var/folders/MR/MRIyTJw1E2i1tfsl1DrF0E+++TI/-Tmp-/npm-9855/1369069615926-0.5003365385346115/tmp.tgz /Users/richardmarr/.npm/3d7030a5-15926-0-5003365385346115-tmp-tgz.lock
18 silly lockFile 3d7030a5-15926-0-5003365385346115-tmp-tgz /var/folders/MR/MRIyTJw1E2i1tfsl1DrF0E+++TI/-Tmp-/npm-9855/1369069615926-0.5003365385346115/tmp.tgz
19 verbose tar unpack /var/folders/MR/MRIyTJw1E2i1tfsl1DrF0E+++TI/-Tmp-/npm-9855/1369069615926-0.5003365385346115/tmp.tgz
20 silly lockFile 4ca48960-15926-0-5003365385346115-package /var/folders/MR/MRIyTJw1E2i1tfsl1DrF0E+++TI/-Tmp-/npm-9855/1369069615926-0.5003365385346115/package
21 verbose lock /var/folders/MR/MRIyTJw1E2i1tfsl1DrF0E+++TI/-Tmp-/npm-9855/1369069615926-0.5003365385346115/package /Users/richardmarr/.npm/4ca48960-15926-0-5003365385346115-package.lock
22 silly gunzTarPerm modes [ '755', '644' ]
23 silly gunzTarPerm extractEntry package.json
24 silly gunzTarPerm extractEntry .npmignore
25 silly gunzTarPerm extractEntry README.md
26 silly gunzTarPerm extractEntry index.js
27 silly gunzTarPerm extractEntry .travis.yml
28 silly gunzTarPerm extractEntry examples/twitter/README.md
29 silly gunzTarPerm extractEntry examples/twitter/tweemitter.js
30 silly gunzTarPerm extractEntry examples/twitter/tweet-data.js
31 silly gunzTarPerm extractEntry examples/twitter/tweet-search.js
32 silly gunzTarPerm extractEntry examples/twitter/tweet.js
33 silly gunzTarPerm extractEntry lib/engine.js
34 silly gunzTarPerm extractEntry test/offline-filter-test.js
35 silly gunzTarPerm extractEntry test/online-sync-test.js
36 verbose read json /var/folders/MR/MRIyTJw1E2i1tfsl1DrF0E+++TI/-Tmp-/npm-9855/1369069615926-0.5003365385346115/package/package.json
37 silly lockFile 4ca48960-15926-0-5003365385346115-package /var/folders/MR/MRIyTJw1E2i1tfsl1DrF0E+++TI/-Tmp-/npm-9855/1369069615926-0.5003365385346115/package
38 verbose from cache /var/folders/MR/MRIyTJw1E2i1tfsl1DrF0E+++TI/-Tmp-/npm-9855/1369069615926-0.5003365385346115/package/package.json
39 verbose tar pack [ '/Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package.tgz',
39 verbose tar pack   '/var/folders/MR/MRIyTJw1E2i1tfsl1DrF0E+++TI/-Tmp-/npm-9855/1369069615926-0.5003365385346115/package' ]
40 verbose tarball /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package.tgz
41 verbose folder /var/folders/MR/MRIyTJw1E2i1tfsl1DrF0E+++TI/-Tmp-/npm-9855/1369069615926-0.5003365385346115/package
42 silly lockFile e2311c32-l-couchelastic-0-1-3-package-tgz /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package.tgz
43 verbose lock /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package.tgz /Users/richardmarr/.npm/e2311c32-l-couchelastic-0-1-3-package-tgz.lock
44 silly lockFile e2311c32-l-couchelastic-0-1-3-package-tgz /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package.tgz
45 silly lockFile b92750f6-ceful-couchelastic-0-1-3-package /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package
46 verbose lock /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package /Users/richardmarr/.npm/b92750f6-ceful-couchelastic-0-1-3-package.lock
47 silly lockFile b92750f6-ceful-couchelastic-0-1-3-package /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package
48 verbose tar unpack /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package.tgz
49 silly lockFile b92750f6-ceful-couchelastic-0-1-3-package /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package
50 verbose lock /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package /Users/richardmarr/.npm/b92750f6-ceful-couchelastic-0-1-3-package.lock
51 silly gunzTarPerm modes [ '755', '644' ]
52 silly gunzTarPerm extractEntry package.json
53 silly gunzTarPerm extractEntry .npmignore
54 silly gunzTarPerm extractEntry README.md
55 silly gunzTarPerm extractEntry index.js
56 silly gunzTarPerm extractEntry .travis.yml
57 silly gunzTarPerm extractEntry examples/twitter/README.md
58 silly gunzTarPerm extractEntry examples/twitter/tweemitter.js
59 silly gunzTarPerm extractEntry examples/twitter/tweet-data.js
60 silly gunzTarPerm extractEntry examples/twitter/tweet-search.js
61 silly gunzTarPerm extractEntry examples/twitter/tweet.js
62 silly gunzTarPerm extractEntry lib/engine.js
63 silly gunzTarPerm extractEntry test/offline-filter-test.js
64 silly gunzTarPerm extractEntry test/online-sync-test.js
65 verbose read json /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package/package.json
66 silly lockFile b92750f6-ceful-couchelastic-0-1-3-package /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package
67 silly shasum updated bytes 7322
68 info shasum 7a8d6aeb8a2fe7e393eeaf9ce49664969a50d37b
68 info shasum /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package.tgz
69 verbose from cache /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package/package.json
70 verbose chmod /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package.tgz 644
71 verbose chown /Users/richardmarr/.npm/resourceful-couchelastic/0.1.3/package.tgz [ 501, 20 ]
72 silly lockFile 3a52ce78- .
73 silly publish { author: { name: 'Richard Marr', email: 'richard.marr@gmail.com' },
73 silly publish   name: 'resourceful-couchelastic',
73 silly publish   description: 'Hybrid Couchdb/Elasticsearch engine for Resourceful',
73 silly publish   version: '0.1.3',
73 silly publish   repository:
73 silly publish    { type: 'git',
73 silly publish      url: 'git://github.com/richmarr/resourceful-couchelastic.git' },
73 silly publish   main: 'index.js',
73 silly publish   scripts: { test: 'vows test/offline-* --spec -i' },
73 silly publish   engines: { node: '~0.4.7' },
73 silly publish   dependencies: { 'resourceful-elasticsearch': '0.1.3', resourceful: '0.1.6' },
73 silly publish   devDependencies: { cradle: '0.5.x', vows: '~0.6.0' },
73 silly publish   readme: '# resourceful-couchelastic [![Build Status](https://secure.travis-ci.org/richmarr/resourceful-couchelastic.png)](http://travis-ci.org/richmarr/resourceful-couchelastic)\n\nThe goal of CouchElastic is to provide seamless full-text and parametric search to Node.js apps, \naccomplished via [Flatiron][2]\'s [Resourceful][3] ODM layer and the awesome power of CouchDB and [Elasticsearch][4]. \n\n\n## Configuration\n\nStart up an empty instance of CouchDB and an empty instance of Elasticsearch, then do this:\n\n``` js\n\tvar resourceful = require(\'resourceful\'),\n\t\tCouchelastic = require(\'resourceful-couchelastic\').Couchelastic;\n\t\n\tresourceful.engines.Couchelastic = Couchelastic;  // patch in the engine\n\tresourceful.use( \'couchelastic\', {\n\t\t// CouchDB settings\n\t\thost : \'localhost\', // optional - defaults to localhost\n\t\tport : 5984,        // optional - defaults to 5984\n\t\tdatabase:\'db-name\', // required\n\t\tsearch:{\n\t\t\t// Elasticsearch settings\n\t\t\tindex:\'my-index-name\'  // optional - defaults to db name\n\t\t}\n\t});\n```\n\nFrom this point onwards each `Resource` that you define will have its data stored in your specified \nCouchDB cluster and have an Elasticsearch indexing river configured to index the data for searching.\n\n## Define a resource\n\nAssuming you\'re already defining resources with Resourceful nothing more is required, but there are some additional options you might want to use. \nEverything specified within the options.search is passed straight into ES\'s Mapping API, allowing you fine-grained control over how that individual \nfield is treated in the index.\n\n``` js\n\tvar Creature = resourceful.define(\'Creature\', function(){\n\t\tthis.string(\'name\',{ required:true });\n\t\tthis.string(\'genus\');\n\t\tthis.number(\'population\');\n\t\tthis.number(\'legs\',{\n\t\t\trequired: true,        // validation rules\n\t\t\tminimum: 0,\n\t\t\tsearch:{               \n\t\t\t\ttype:\'integer\'       // this tells ES what type of number this is\n\t\t\t}\n\t\t});\n\t\tthis.array(\'eats\',{\n\t\t\tsearch:{ type:\'string\' }\n\t\t});\n\t\tthis.string(\'geography\',{\n\t\t\tsearch:{\n\t\t\t\tanalyzer:\'snowball\'  // stem words to match word stem rather than exact form.\n\t\t\t}\n\t\t});\n\t});\n```\n\n## Synchronise your schema\n\nThe `sync()` method sets up your data sources for you. Until you sync you can `save()` and `get()` but not much more. \n\nFor each `Resource` type `sync` does the following:\n\n * Saves a CouchDB design document \n * Saves an Elasticsearch Mapping document\n * Creates a River on the Elasticsearch cluster that listens to CouchDB\'s replication stream\n\nYou\'ll need to `sync` after you make any significant design changes so that they\'re carried through to the schemas of both servers. Be aware that changing the data type of a field after data has already been indexed can be problematic.\n\n## Searching\n\nAssuming you\'ve defined a Creature as per the Resourceful docs you should be able to search your database in free text like this.\n\n``` js\n\tCreature.search("fur",function( err, creatures, response ){\n\t\t// creatures is a convenient array of Creature objects that match the search\n\t\t// response contains the entire ES response including search results and metadata\n\t});\n```\n\nYou can also search using the Elasticsearch query DSL, for example the following `fuzzy` query would also match the word "oscar"\n\n``` js\n\tActor.search({\n\t\tquery : {\n    \t\tfuzzy : { text : "socar" }\t\n\t\t}\n\t},function( err, actors, response ){\n\t\t// actors is an array\n\t\t// response is the full response containing metadata, e.g. facets\n\t});\n```\n\nOr using Resoureceful\'s parametric query method `Resourece.find()`\n\n``` js\n\tCreature.find({\n\t\tlegs:4,\n\t\teats:"wasps"\n\t},function( err, creatures, response ){\n\t\t// \n\t});\n```\n### Joining\n\nIf you have two data types related by a one-to-many foreign key you can do this (many-many not available yet): \n\n``` js\n\tCreature.search("name:wolf",function( err, creatures ){\n\t\tGenus.join( creatures, function( err, creatures ){\n\t\t\t// creatures now contains:\n\t\t\t//     creature.genus_id - foreign key\n\t\t\t//     creature.genus - linked entity\n\t\t});\n\t});\n```\n\n### Security\n\nIf some of your Resource data is sensitive you might want to block it from being indexed\n\n``` js\n\tvar Employee = resourceful.define(\'Employee\', function(){\n\t\tthis.string(\'name\');\n\t\tthis.number(\'salary\',{search:{index:\'no\'}});\n\t});\n```\n\n\n\nTODO - clean up the object search API and allow faceting etc.\n\n## Installation\n\n``` bash\n\tnpm install resourceful-couchelastic`\n```\n\n## Tests\n\nAll tests are written with [vows][0] and should be run with [npm][1]:\n\n``` bash\n  $ npm test\n```\n\n#### Author: Richard Marr\n#### License: Apache 2.0\n\n\n[0]: http://vowsjs.org\n[1]: http://npmjs.org\n[2]: http://flatironjs.org/\n[3]: https://github.com/flatiron/resourceful/\n[4]: http://www.elasticsearch.org',
73 silly publish   readmeFilename: 'README.md',
73 silly publish   _id: 'resourceful-couchelastic@0.1.3',
73 silly publish   dist: { shasum: '7a8d6aeb8a2fe7e393eeaf9ce49664969a50d37b' } }
74 verbose url raw resourceful-couchelastic
75 verbose url resolving [ 'https://registry.npmjs.org/', './resourceful-couchelastic' ]
76 verbose url resolved https://registry.npmjs.org/resourceful-couchelastic
77 info trying registry request attempt 1 at 18:06:57
78 http PUT https://registry.npmjs.org/resourceful-couchelastic
79 http 409 https://registry.npmjs.org/resourceful-couchelastic
80 verbose url raw resourceful-couchelastic
81 verbose url resolving [ 'https://registry.npmjs.org/', './resourceful-couchelastic' ]
82 verbose url resolved https://registry.npmjs.org/resourceful-couchelastic
83 info trying registry request attempt 1 at 18:06:59
84 http GET https://registry.npmjs.org/resourceful-couchelastic
85 http 200 https://registry.npmjs.org/resourceful-couchelastic
86 error publish fail Cannot publish over existing version.
86 error publish fail Bump the 'version' field, set the --force flag, or
86 error publish fail     npm unpublish 'resourceful-couchelastic@0.1.3'
86 error publish fail and try again
87 error System Darwin 10.8.0
88 error command "/Users/richardmarr/Projects/nvm/v0.8.14/bin/node" "/Users/richardmarr/Projects/nvm/v0.8.14/bin/npm" "publish"
89 error cwd /Users/richardmarr/Projects/resourceful-couchelastic
90 error node -v v0.8.14
91 error npm -v 1.1.65
92 error code EPUBLISHCONFLICT
93 verbose exit [ 1, true ]
